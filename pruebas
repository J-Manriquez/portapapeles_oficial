
def encode_formatted_text(self, text_data):
    if isinstance(text_data, str):
        # Si text_data es una cadena, la tratamos como texto simple
        return {
            'text': text_data,
            'format': {}
        }
    elif isinstance(text_data, dict):
        # Si text_data es un diccionario, asumimos que tiene la estructura esperada
        text = text_data.get('text', '')
        formatted = text_data.get('formatted', {})
        
        if isinstance(formatted, dict):
            return {
                'text': text,
                'format': {
                    'font': formatted.get('font'),
                    'size': formatted.get('size'),
                    'color': formatted.get('color'),
                    'bold': formatted.get('bold'),
                    'italic': formatted.get('italic'),
                    'rtf': formatted.get('rtf'),
                    'html': formatted.get('html'),
                    'underline': formatted.get('underline'),
                    'strikethrough': formatted.get('strikethrough'),
                    'superscript': formatted.get('superscript'),
                    'subscript': formatted.get('subscript'),
                    'background_color': formatted.get('background_color'),
                    'alignment': formatted.get('alignment'),
                }
            }
        else:
            # Si 'formatted' no es un diccionario, devolvemos un formato vacío
            return {
                'text': text,
                'format': {}
            }
    else:
        # Para cualquier otro tipo, convertimos a string y devolvemos sin formato
        return {
            'text': str(text_data),
            'format': {}
        }
        
1. Materiales necesarios:
Una pera de enema o un kit de irrigación anal (disponible en farmacias).
Agua tibia (ni caliente ni fría). No uses jabones ni sustancias irritantes.
Lubricante a base de agua.
Toallas o papel higiénico.
{\rtf1\ansi\deff0{\fonttbl{\f0\fnil Consolas, 'Courier New', monospace;}}\f0 groups": {},
\par     "pinned_items": {},
\par     "settings": {
\par         "height": 400,
\par         "width": 295,
\par         "hotkey": "z"
\par     }}

1. Materiales necesarios:
Una pera de enema o un kit de irrigación anal (disponible en farmacias).
Agua tibia (ni caliente ni fría). No uses jabones ni sustancias irritantes.
Lubricante a base de agua.
Toallas o papel higiénico.{\rtf1\ansi\deff0\f0\b 1. Materiales necesarios:\par Una pera de enema o un kit de irrigación anal (disponible en farmacias).\par Agua tibia (ni caliente ni fría). No uses jabones ni sustancias irritantes.\par Lubricante a base de agua.\par Toallas o papel higiénico.}

{\rtf1\ansi\deff0{\fonttbl{\f0\fnil Consolas, 'Courier New', monospace;}}\f0 },
\par     "settings": {
\par         "height": 400,
\par         "width": 295,
\par         "hotkey": "z"
\par     }
\par }}

groups": {},
    "pinned_items": {},
    "settings": {
        "height": 400,
        "width": 295,
        "hotkey": "z"
    }